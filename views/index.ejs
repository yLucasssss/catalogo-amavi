<%- include('partials/header') %>

<h1 class="text-start">Cat치logo de Pe칞as</h1>

<div class="d-flex justify-content-start flex-wrap mb-4 filter-buttons mt-4">
  <a href="/" class="btn <%= typeof selectedType === 'undefined' || selectedType === '' ? 'active' : '' %>">Todos</a>
  <a href="/?tipo=Anel" class="btn <%= typeof selectedType !== 'undefined' && selectedType === 'Anel' ? 'active' : '' %>">Anel</a>
  <a href="/?tipo=Colar" class="btn <%= typeof selectedType !== 'undefined' && selectedType === 'Colar' ? 'active' : '' %>">Colar</a>
  <a href="/?tipo=Pulseira" class="btn <%= typeof selectedType !== 'undefined' && selectedType === 'Pulseira' ? 'active' : '' %>">Pulseira</a>
  <a href="/?tipo=Berloque" class="btn <%= typeof selectedType !== 'undefined' && selectedType === 'Berloque' ? 'active' : '' %>">Berloque</a>
  <a href="/?tipo=Piercing" class="btn <%= typeof selectedType !== 'undefined' && selectedType === 'Piercing' ? 'active' : '' %>">Piercing</a>
  <a href="/?tipo=Brinco" class="btn <%= typeof selectedType !== 'undefined' && selectedType === 'Brinco' ? 'active' : '' %>">Brinco</a>
  <a href="/?tipo=Trio" class="btn <%= typeof selectedType !== 'undefined' && selectedType === 'Trio' ? 'active' : '' %>">Trio</a>
  <a href="/?tipo=Bracelete" class="btn <%= typeof selectedType !== 'undefined' && selectedType === 'Bracelete' ? 'active' : '' %>">Bracelete</a>
</div>

<div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">
  <% if (typeof pecas !== 'undefined' && pecas.length > 0) { %>
    <% pecas.forEach(peca => { %>
      <div class="col">
        <div class="card h-100 <%= peca.disponibilidade === 'esgotado' ? 'sold-out-card' : '' %>" data-bs-toggle="modal" data-bs-target="#detailModal_<%= peca.id %>">
          <img src="<%= peca.imagem %>" class="card-img-top" alt="<%= peca.nome %>">
          <% if (peca.disponibilidade === 'esgotado') { %>
            <div class="sold-out-overlay">
              <span class="sold-out-text">ESGOTADO</span>
            </div>
          <% } %>
          <div class="card-body">
            <h5 class="card-title"><%= peca.nome %></h5>
            <p class="card-text price-text">R$ <%= peca.valor.toFixed(2) %></p>
            <% if (peca.disponibilidade === 'esgotado') { %>
              <p class="card-text availability-text sold-out">ESGOTADO</p>
            <% } %>
            <% if (peca.tipo === 'Anel') { %>
              <p class="card-text size-text">Tamanho: <%= peca.tamanho %></p>
            <% } %>
          </div>
        </div>
      </div>

      <!-- Modal -->
      <div class="modal fade" id="detailModal_<%= peca.id %>" tabindex="-1" aria-labelledby="detailModalLabel_<%= peca.id %>" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="detailModalLabel_<%= peca.id %>"><%= peca.nome %></h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <div class="row">
                <div class="col-md-6">
                  <img src="<%= peca.imagem %>" class="img-fluid rounded" alt="<%= peca.nome %>">
                </div>
                <div class="col-md-6">
                  <h3>R$ <%= peca.valor.toFixed(2) %></h3>
                  <% if (peca.disponibilidade === 'esgotado') { %>
                    <p class="lead text-danger"><br>&#9888; Essa pe칞a linda est치 fora de estoque no momento, mas podemos fazer o pedido especialmente pra voc칡 com todo carinho! 游눘</p>
                  <% } else { %>
                    <p class="lead text-success">Dispon칤vel</p>
                  <% } %>
                  <% if (peca.tipo === 'Anel') { %>
                    <p><strong>Tamanho:</strong> <%= peca.tamanho %></p>
                  <% } %>
                  <p><strong>Tipo:</strong> <%= peca.tipo %></p>
                  <a href="https://wa.me/5535998818786?text=<%= encodeURIComponent(peca.disponibilidade === 'esgotado' ? `Oii Estava vendo o cat치logo e me apaixonei pela pe칞a "${peca.nome}"\nSei que ela est치 esgotada no momento, mas posso encomendar especialmente pra mim? Quero garantir a minha! Como fa칞o pra encomendar?` : `Oii, estava vendo o cat치logo e me apaixonei pela pe칞a "${peca.nome}"\nJa quero garantir a minha! Como fa칞o pra comprar?`) %>" target="_blank" class="btn btn-buy-custom mt-3"><i class="fas fa-shopping-cart"></i> <%= peca.disponibilidade === 'esgotado' ? 'Encomendar' : 'Comprar' %></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% }); %>
  <% } else { %>
    <p>Nenhuma pe칞a cadastrada.</p>
  <% } %>
</div>

<%- include('partials/footer') %>